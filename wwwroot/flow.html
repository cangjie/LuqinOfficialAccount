<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="css/table.css" />
    <link rel="stylesheet" href="css/bootstrap.css" />
    <link rel="stylesheet" href="css/bootstrap-grid.css" />
    <link rel="stylesheet" href="css/bootstrap-reboot.css" />
    <script type="text/javascript" src="js/jquery-3.6.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/Util.js"></script>
    <script type="text/javascript" src="js/api_description.js"></script>
</head>
<body>
    <div>
        <h1 id="gid" ></h1>

    </div>
    <table style="width:100%">
        <thead>
            <tr>
                <td class="table_head">日期</td>
                <td class="table_head">特</td>
                <td class="table_head">大</td>
                <td class="table_head">中</td>
                <td class="table_head">小</td>
            </tr>
        </thead>
        <tbody id="count_table">
        </tbody>
    </table>
</body>
</html>
<script type="text/javascript" >
    var gid = getUrlParameter('gid');
    //var url = 'https://stockpage.10jqka.com.cn/' + gid.substring(2, 8) + '/funds/'
    //window.location.href = url;
    
    
    var gidDiv = document.getElementById('gid')
    gidDiv.innerText = gid;// + ' ' + url;
    var ajaxUrl = '/api/DealCount/GetDealCount/' + gid;
    $.ajax({
        url: ajaxUrl,
        type: 'GET',
        success: function (msg, status) {

            



            if (status != 'success') {
                return;
            }
            var msgFlow = msg
            var tbody = document.getElementById('count_table');
            var total = 0;
            for (var i = 0; i < msg.length; i++) {

                total = msgFlow[i].total == 0 ? total : msgFlow[i].total;
                var huge = msgFlow[i].net_huge_volume;
                var big = msgFlow[i].net_big_volume;
                var mid = msgFlow[i].net_mid_volume;
                var small = msgFlow[i].net_small_volume;

                var dayTime = (msgFlow[i].type == 'day') ?
                    formatDate(new Date(msgFlow[i].settleTime))
                    : formatTime(new Date(msgFlow[i].settleTime));

                var tr = document.createElement('tr');
                var trClass = document.createAttribute('class');
                trClass.value = (msgFlow[i].type == 'day') ? 'table_body_row_day' : 'table_body_row';
                tr.attributes.setNamedItem(trClass);

                var td = document.createElement('td');
                td.innerText = dayTime;
                tr.appendChild(td);

                var txtHuge = '-';
                var txtBig = '-';
                var txtMid = '-';
                var txtSmall = '-';
                if (total > 0) {
                    txtHuge = Math.round(10000 * parseFloat(huge) / parseFloat(total), 2);
                    txtBig = Math.round(10000 * parseFloat(big) / parseFloat(total), 2);
                    txtMid = Math.round(10000 * parseFloat(mid) / parseFloat(total), 2);
                    txtSmall = Math.round(10000 * parseFloat(small) / parseFloat(total), 2);
                }

                td = document.createElement('td');
                //td.id = msgFlow[i].alert_date.toString().split('T')[0];
                td.innerText = txtHuge;
                tr.appendChild(td);

                td = document.createElement('td');
                td.innerText = txtBig;
                tr.appendChild(td);

                td = document.createElement('td');
                td.innerText = txtMid;
                tr.appendChild(td);

                td = document.createElement('td');
                td.innerText = txtSmall;
                tr.appendChild(td);



                tbody.appendChild(tr);







                
            }
           

            //console.log('get daily', msg);
        }
    });
</script>